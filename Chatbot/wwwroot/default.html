<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mental Health Bot</title>
    <style>
        body {
            margin: 0px;
            padding: 0px;
            font-family: Segoe UI;
        }

        html,
        body {
            overflow: hidden;
            height: 100%;
        }
        
        #webchat{
          position: absolute;
          bottom: 0;
          width: 50%;
          max-height: 40%;
          overflow: auto
        }
    </style>
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/content.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            loadFrame();
        });
        var loadFrame = function () {
            var iframe = document.createElement('iframe');
            iframe.setAttribute("id", "iframe");
            var offLineHTMLContent = "";
            var frameElement = document.getElementById("how-to-iframe");
            if (window.navigator.onLine) {
                iframe.src = 'https://docs.botframework.com/static/abs/pages/f5.htm';
                iframe.setAttribute("scrolling", "no");
                iframe.setAttribute("frameborder", "0");
                iframe.setAttribute("width", "100%");
                iframe.setAttribute("height", "100%");
                var frameDiv = document.getElementById("how-to-iframe");
                frameDiv.appendChild(iframe);
            } else {
                frameElement.classList.add("remove-frame-height");
            }
        };
    </script>
</head>

<body>
    <header class="header">
        <div class="header-inner-container">
            <div class="header-icon" style="display: inline-block"></div>
            <div class="header-text" style="display: inline-block">Mental Health Bot</div>
        </div>
    </header>
    <div class="row">
        <div class="column" class="main-content-area">
            <div class="content-title">Welcome</div>
     
            <!--Method 1: Embed directly-->
            <!--<iframe src='https://webchat.botframework.com/embed/MHBot?s=<INSERT BOT SECRET HERE>'  style='min-width: 400px; width: 100%; min-height: 500px;'></iframe>-->
 
            <!--Method 2: Using secret-->
            <!--Method 3: Get token via request-->
            <div id="webchat" role="main"></div>
        </div>
    </div>
</body>


<script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>
<script src="userInfo.js"></script>
<script>
    const styleOptions = {
        botAvatarImage: 'img/bot-img.png',
        userAvatarImage: 'img/user-img.png',
        botAvatarInitials: 'MH',
        userAvatarInitials: 'WC',
        bubbleBackground: 'rgba(0, 0, 255, .1)',
        bubbleFromUserBackground: 'rgba(0, 255, 0, .1)',
        // rootHeight: '50%',
        // rootWidth: '50%'
    };
    
    window.WebChat.renderWebChat(
    {
       directLine: window.WebChat.createDirectLine({
          secret: getBotSecret() // Comes from userInfo.js
       }),
       styleOptions
    },
    document.getElementById('webchat')
    );
    
    // Method 3: Get token via request
    // var xhr = new XMLHttpRequest();
    // xhr.open('GET', "https://webchat.botframework.com/api/tokens", true);
    // xhr.setRequestHeader('Authorization', 'BotConnector ' + getBotSecret());
    // xhr.send();
    // xhr.onreadystatechange = processRequest;

    // function processRequest(e) {
    //   if (xhr.readyState == 4  && xhr.status == 200) {
    //     var response = JSON.parse(xhr.responseText);
    //     // document.getElementById("chat").src="https://webchat.botframework.com/embed/MHBot?t="+response
    //     window.WebChat.renderWebChat(
    //         {
    //            directLine: window.WebChat.createDirectLine({
    //               token: response
    //            }),
    //            userID: 'YOUR_USER_ID',
    //            username: 'Web Chat User',
    //            locale: 'en-US',
    //            botAvatarInitials: 'WC',
    //            userAvatarInitials: 'WW'
    //         },
    //         document.getElementById('webchat')
    //      );
    //   }
    // }
  </script>
</html>
